angular.module("adminPanel.authentication",[]).controller("authController",["$scope","authFactory","md5","store","$state","$stateParams",function(a,b,c,d,e,f){return"recovery"!==f.type||_.isUndefined(f.value)||_.isUndefined(f.email)?(a.recovery_screen=!1,a.header="Login"):(a.recovery_screen=!0,a.header="Reset Password"),a.forgotPassword=!1,a.viewPass=!1,a.passType="password",a.passIcon="mdi-action-visibility-off",a.toggleShowPassword=function(){return a.viewPass===!1?(a.viewPass=!0,a.passType="text",a.passIcon="mdi-action-visibility"):(a.viewPass=!1,a.passType="password",a.passIcon="mdi-action-visibility-off")},a.login=function(a){var f;return f={email:a.email,password:c.createHash(a.password||"")},b.login(f).then(function(a){var b,c;return b=a.data,"Error"===b.status?Materialize.toast(b.message,"4000"):(c={id:b.id,token:b.token,username:b.username,lastUpdate:moment().format("DD-MM-YYYY")},d.set("user",c),e.go("dashboard.home"),Materialize.toast(b.message,"4000"))},function(a){return Materialize.toast(a.data.message,"4000")})},a.recoverPassword=function(a){return b.recoverPassword(a).then(function(a){var b;return b=a.data,console.log(b),Materialize.toast(b.message,4e3)},function(a){return Materialize.toast(a.data.message,4e3)})},a.toggleForgotPass=function(){return a.forgotPassword===!1?(a.forgotPassword=!0,a.header="Recover Password"):(a.forgotPassword=!1,a.header="Login")},a.updatePassword=function(a){var d;return a.password===a.cpassword?(d={password:c.createHash(a.password||""),email:f.email,value:f.value},b.updatePassword(d).then(function(a){var b;return b=a.data,Materialize.toast(b.status+" - "+b.message,4e3),e.go("auth",{type:"login",email:null,value:null})},function(a){return Materialize.toast("Opps something went wrong",4e3)})):Materialize.toast("Passwords do not match",4e3)}}]);