angular.module("dashBoard.pagesCtrl").controller("dashBoardManageMailController",["$scope","mailFactory",function(a,b){var c;return c=0,a.mails=[],a.fetchMail=function(){return b.fetchMail(c).then(function(b){var c;return"Success"===b.data.status?(c=JSON.parse(b.data.results),_.each(c,function(b){return a.mails.push(b)}),Materialize.toast(b.data.message,4e3)):Materialize.toast(b.data.message,4e3)},function(a){return Materialize.toast("Something went wrong",4e3)})},a.loadMoreMail=function(){return c=a.mails.length,a.fetchMail()},a.detailedView=function(b){var c;return c=a.mails[b],a.detailedMail={index:b,sender_name:c.sender_name,sender_email:c.sender_email,sender_subject:c.sender_subject,sender_message:c.sender_message}},a["delete"]=function(c){var d;return d=a.mails[c].id,b.deleteMail(d).then(function(b){return"Success"===b.data.status?(a.mails.splice(c,1),a.detailedMail={},Materialize.toast(b.data.message,4e3)):Materialize.toast(b.data.message,4e3)},function(a){return Materialize.toast("Something went wrong",4e3)})},a.openReplyModal=function(){return $("#replyModal").openModal()},a.sendReply=function(){return a.reply.to_name=a.detailedMail.sender_name,a.reply.to_email=a.detailedMail.sender_email,a.reply.subject="RE: "+a.detailedMail.sender_subject,a.reply.finalmsg='Sent message:"<i>'+a.detailedMail.sender_message+'</i>" <br><br>'+a.reply.msg,b.sendMail(a.reply).then(function(b){return"Success"===b.data.status?(a.reply={},$("#replyModal").closeModal(),Materialize.toast(b.data.message,4e3)):Materialize.toast(b.data.message,4e3)},function(a){return Materialize.toast("Something went wrong",4e3)})}}]).filter("myDate",function(){return function(a){return a?moment(a,"YYYY-MM-DD h:mm:ss a").format("dddd, MMMM Do YYYY, h:mm a"):void 0}});